import{r as e,x as s,bg as a}from"./vendor.Dh2ak8C9.js";import{aw as t,ax as r,aA as o}from"./radix-ui.DLrWTp4s.js";import{L as i,e as n,S as c,u as m,a as l,s as d,T as u,c as j,B as x}from"./index.Bgs2qY_N.js";import{u as p}from"./tanstack-vendor.DOuvbdIT.js";import"./utilities.DczjhRIE.js";import"./animations.diCFyb6j.js";import{T as g,Z as h,c as f,f as b}from"./headlessui.C21Jgir0.js";import"./react-interactions.BmDrs_uO.js";import"./markdown_highlight.YFvJ8PVJ.js";import"./validation.5kC5QJv1.js";import"./math-katex.iIKN0cd0.js";import"./i18n.B5UIjsUY.js";import"./routing.rjvVY3ZG.js";import"./http-client.BN6bS8zJ.js";import"./date-utils.j-oxXFG2.js";import"./forms.BIbDXFcb.js";import"./framer-motion.BWAWz2lL.js";import"./advanced-inputs.D7SuqGtn.js";import"./security-ui.DhHgY4iQ.js";import"./markdown-processing.BCubbpZw.js";import"./avatars.DlTYoDdb.js";import"./virtualization.MklTREKW.js";import"./heic-converter.Cz_Prg7D.js";import"./sandpack.Cm9YcV0h.js";import"./codemirror-core.DD9WsS3J.js";import"./codemirror-state.Pf71Wo5N.js";import"./codemirror-view.jjAZtrOT.js";import"./codemirror-language.B8XIr2fL.js";const v=({tag:a,selected:o,handleSubmit:i,icon:n,...m})=>{const[l,d]=e.useState(!1);return s.jsx(g,{"aria-label":a,className:"group flex w-full gap-2 rounded-lg p-2.5 text-sm text-text-primary transition-colors duration-200 focus:outline-none data-[focus]:bg-surface-hover data-[focus-visible]:ring-2 data-[focus-visible]:ring-primary",...m,as:"button",onClick:async()=>{"New Bookmark"!==a?(d(!0),i(a),d(!1)):i()},children:s.jsx("div",{className:"flex grow items-center justify-between gap-2",children:s.jsxs("div",{className:"flex items-center gap-2",children:[null!=n?n:l?s.jsx(c,{className:"size-4"}):o?s.jsx(t,{className:"size-4"}):s.jsx(r,{className:"size-4"}),s.jsx("div",{style:{wordBreak:"break-word",overflowWrap:"anywhere"},children:a})]})})})},k=({tags:e,handleSubmit:a,header:t})=>{const{bookmarks:r}=m();return s.jsxs(s.Fragment,{children:[t,r.length>0&&s.jsx("div",{className:"my-1.5 h-px",role:"none"}),r.map(((t,r)=>s.jsx(v,{tag:t.tag,selected:e.includes(t.tag),handleSubmit:a},`${t._id??t.tag}-${r}`)))]})},y=({conversation:a,tags:t=[],setTags:r})=>{const[i,n]=e.useState(),{bookmarks:c}=m(),d=l();e.useEffect((()=>{i||n(a)}),[a,i]);const u=()=>{r([])};return 0===c.length?s.jsxs("div",{className:"flex flex-col",children:[s.jsx(v,{tag:d("com_ui_clear_all"),"data-testid":"bookmark-item-clear",handleSubmit:u,selected:!1,icon:s.jsx(o,{className:"size-4"})}),s.jsx(v,{tag:d("com_ui_no_bookmarks"),"data-testid":"bookmark-item-no-bookmarks",handleSubmit:()=>Promise.resolve(),selected:!1,icon:"ðŸ¤”"})]}):s.jsx("div",{className:"flex flex-col",children:s.jsx(k,{tags:t,handleSubmit:e=>{if(void 0===e)return;const s=(e=>t.some((s=>s===e))?t.filter((s=>s!==e)):[...t,e])(e);r(s)},header:s.jsx(v,{tag:d("com_ui_clear_all"),"data-testid":"bookmark-item-clear",handleSubmit:u,selected:!1,icon:s.jsx(o,{className:"size-4"})})})})},N=({tags:o,setTags:c,isSmallScreen:m})=>{const g=l(),{data:v}=p([n.conversationTags],(()=>i.getConversationTags()),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...k});var k;const N=a(d.conversationByIndex(0)),w=e.useMemo((()=>o.length>0?o.join(", "):g("com_ui_bookmarks")),[o,g]);return s.jsx(h,{as:"div",className:"group relative",children:({open:e})=>s.jsxs(s.Fragment,{children:[s.jsx(u,{description:w,render:s.jsx(f,{id:"bookmark-menu-button","aria-label":g("com_ui_bookmarks"),className:j("flex items-center justify-center","size-10 border-none text-text-primary hover:bg-accent hover:text-accent-foreground","rounded-full border-none p-2 hover:bg-surface-hover md:rounded-xl",e?"bg-surface-hover":""),"data-testid":"bookmark-menu",children:o.length>0?s.jsx(t,{className:j("text-text-primary",m?"icon-md-heavy":"icon-lg"),"aria-hidden":"true"}):s.jsx(r,{className:j("text-text-primary",m?"icon-md-heavy":"icon-lg"),"aria-hidden":"true"})})}),s.jsx(b,{anchor:"bottom",className:"absolute left-0 top-full z-[100] mt-1 w-60 translate-y-0 overflow-hidden rounded-lg bg-surface-secondary p-1.5 shadow-lg outline-none",children:v&&N&&s.jsx(x.Provider,{value:{bookmarks:v.filter((e=>e.count>0))},children:s.jsx(y,{conversation:N,tags:o,setTags:c})})})]})})};export{N as default};
